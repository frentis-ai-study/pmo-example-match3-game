# Feature Specification: Match-3 게임 코어 기능

**Feature Branch**: `001-match3-game-core`
**Created**: 2025-11-07
**Status**: Draft
**Input**: User description: "애니팡처럼 기본 게임 기능 개발"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 기본 게임 플레이 (Priority: P1)

사용자는 그리드에 배치된 블록들을 스와이프하여 같은 종류의 블록 3개 이상을 연속으로 매칭시켜 제거하고 점수를 획득할 수 있다.

**Why this priority**: 게임의 가장 핵심적인 메커니즘으로, 이것 없이는 게임이 성립되지 않음. MVP로 이 기능만으로도 플레이 가능한 게임이 완성됨.

**Independent Test**: 게임을 시작하여 블록을 스와이프하고, 3개 이상 매칭 시 블록이 제거되며 점수가 증가하는 것을 확인. 빈 공간에 새 블록이 떨어지는 것까지 테스트 가능.

**Acceptance Scenarios**:

1. **Given** 8x8 그리드에 다양한 색상의 블록들이 배치되어 있음, **When** 사용자가 인접한 두 블록을 스와이프하여 위치를 교환, **Then** 3개 이상 같은 색상이 수평/수직으로 연속되면 해당 블록들이 제거되고 점수가 증가함
2. **Given** 블록 제거로 빈 공간이 생김, **When** 제거 애니메이션이 완료됨, **Then** 위쪽 블록들이 중력에 따라 아래로 떨어지고, 빈 공간은 새로운 무작위 블록으로 채워짐
3. **Given** 사용자가 블록을 교환했지만, **When** 교환 결과 3개 이상 매칭이 발생하지 않음, **Then** 블록들이 원래 위치로 되돌아가고 움직임이 취소됨
4. **Given** 블록 제거 후 새 블록이 떨어짐, **When** 떨어진 블록으로 인해 자동으로 3개 이상 매칭이 발생함, **Then** 연쇄 반응(콤보)이 발생하고 추가 점수 보너스가 부여됨

---

### User Story 2 - 게임 세션 관리 (Priority: P2)

사용자는 게임을 시작하고, 진행 중인 게임을 일시정지하며, 종료된 게임의 결과를 확인할 수 있다.

**Why this priority**: 사용자가 게임의 시작과 끝을 제어하고 결과를 확인할 수 있어야 완전한 게임 경험을 제공함. P1 없이는 의미가 없지만, P1만으로도 무한 플레이는 가능.

**Independent Test**: 게임 시작 버튼 클릭 → 플레이 → 일시정지 → 재개 → 게임 오버 시 점수 확인까지 전체 흐름을 독립적으로 테스트 가능.

**Acceptance Scenarios**:

1. **Given** 사용자가 게임 메인 화면에 있음, **When** "게임 시작" 버튼을 클릭, **Then** 8x8 그리드가 무작위 블록들로 초기화되고 점수는 0점부터 시작됨
2. **Given** 게임이 진행 중임, **When** "일시정지" 버튼을 클릭, **Then** 게임 플레이가 멈추고 일시정지 화면이 표시되며, 그리드는 가려지거나 흐려짐
3. **Given** 게임이 일시정지 상태임, **When** "계속하기" 버튼을 클릭, **Then** 이전 상태에서 게임이 재개됨
4. **Given** 더 이상 가능한 매칭이 없거나 제한 시간/이동 횟수가 소진됨, **When** 게임 오버 조건 충족, **Then** 최종 점수와 함께 게임 오버 화면이 표시되고, "다시 하기" 옵션이 제공됨

---

### User Story 3 - 점수 및 진행상황 표시 (Priority: P3)

사용자는 현재 점수, 남은 이동 횟수 또는 시간을 실시간으로 확인할 수 있다.

**Why this priority**: 게임의 진행 상황을 이해하고 전략을 세우는 데 필요. P1, P2 없이는 의미가 없지만, 이 정보 없이도 게임 자체는 플레이 가능.

**Independent Test**: 게임 플레이 중 UI에 점수와 게임 제약 정보가 정확히 업데이트되는지 확인.

**Acceptance Scenarios**:

1. **Given** 게임이 진행 중임, **When** 블록 매칭이 성공할 때마다, **Then** 현재 점수가 실시간으로 증가하여 화면 상단에 표시됨
2. **Given** 게임이 이동 횟수 제한 모드로 시작됨, **When** 사용자가 블록을 교환할 때마다, **Then** 남은 이동 횟수가 1씩 감소하여 표시됨
3. **Given** 연쇄 반응(콤보)이 발생함, **When** 2회 이상 연속 매칭이 자동으로 일어남, **Then** 콤보 카운터가 표시되고 보너스 점수가 추가됨

---

### Edge Cases

- **빈 매칭 경로**: 더 이상 가능한 매칭이 없을 때 자동으로 그리드를 재배치하거나 게임 오버 처리
- **연쇄 반응 무한 루프**: 이론적으로 무한 연쇄가 발생할 수 있는 상황에서 적절한 종료 조건 필요
- **동시 매칭**: 하나의 블록 교환으로 수평/수직 동시에 매칭이 발생하는 경우 처리
- **초기 그리드 생성**: 게임 시작 시 이미 3개 이상 매칭된 상태로 생성되지 않도록 방지
- **빠른 연속 입력**: 사용자가 애니메이션 중 빠르게 다른 블록을 클릭하는 경우 입력 무시 또는 큐잉
- **브라우저 탭 전환**: 게임 중 다른 탭으로 전환했다가 돌아올 때 게임 상태 유지 또는 자동 일시정지

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 시스템은 8x8 그리드를 생성하고 5가지 이상의 구별 가능한 블록 타입으로 무작위 초기화해야 함
- **FR-002**: 사용자는 인접한 두 블록을 터치/클릭 후 드래그하여 위치를 교환할 수 있어야 함
- **FR-003**: 시스템은 블록 교환 후 수평 또는 수직으로 같은 타입이 3개 이상 연속되었는지 자동으로 감지해야 함
- **FR-004**: 매칭된 블록들은 사라지는 애니메이션과 함께 제거되어야 함
- **FR-005**: 블록 제거 후 중력 효과가 적용되어 위쪽 블록들이 빈 공간으로 떨어져야 함
- **FR-006**: 빈 공간은 그리드 상단에서 새로운 무작위 블록으로 채워져야 함
- **FR-007**: 블록이 떨어진 후 자동으로 매칭이 발생하면 연쇄(콤보) 처리되고 추가 점수가 부여되어야 함
- **FR-008**: 3개 매칭 시 기본 점수, 4개 이상 매칭 시 보너스 점수가 부여되어야 함
- **FR-009**: 사용자는 게임을 일시정지하고 재개할 수 있어야 함
- **FR-010**: 시스템은 더 이상 가능한 매칭이 없는지 감지해야 함
- **FR-011**: 게임 오버 시 최종 점수를 표시하고 새 게임 시작 옵션을 제공해야 함
- **FR-012**: 현재 점수는 실시간으로 화면에 표시되어야 함
- **FR-013**: 모든 블록 이동과 제거는 부드러운 애니메이션으로 처리되어야 함 (0.2~0.5초)
- **FR-014**: 게임 상태(그리드 상태, 점수)는 브라우저 로컬 스토리지에 저장되어야 함
- **FR-015**: 사용자가 페이지를 새로고침해도 이전 게임 상태를 복구할 수 있어야 함

### Key Entities

- **Block (블록)**: 그리드를 구성하는 기본 단위. 타입(색상/모양), 위치(행, 열) 속성을 가짐
- **Grid (그리드)**: 8x8 크기의 2차원 배열로 블록들을 관리. 블록의 배치, 이동, 제거를 담당
- **GameState (게임 상태)**: 현재 점수, 이동 횟수, 일시정지 여부, 게임 오버 여부 등 게임의 전반적인 상태 정보
- **Match (매칭)**: 3개 이상 연속된 같은 타입의 블록들의 집합. 제거 대상이 됨
- **Move (이동)**: 사용자의 블록 교환 동작. 시작 위치와 종료 위치 정보를 포함

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 사용자는 게임 시작부터 첫 블록 매칭까지 5초 이내에 완료할 수 있어야 함
- **SC-002**: 블록 교환 후 매칭 감지 및 제거까지 응답 시간이 100ms 이내여야 함
- **SC-003**: 모든 애니메이션(블록 교환, 제거, 낙하)이 초당 60프레임으로 부드럽게 실행되어야 함
- **SC-004**: 게임이 최소 100회 이동 동안 성능 저하 없이 실행되어야 함
- **SC-005**: 사용자의 90%가 튜토리얼 없이 첫 번째 매칭을 성공시킬 수 있어야 함
- **SC-006**: 게임 로딩 시간이 3초를 초과하지 않아야 함
- **SC-007**: 연쇄 반응이 5회 이상 연속으로 발생해도 정상 작동해야 함
- **SC-008**: 모바일 브라우저와 데스크톱 브라우저에서 동일한 게임 경험을 제공해야 함

## Assumptions

- 게임은 웹 브라우저에서 실행되며, 모던 브라우저(Chrome, Firefox, Safari, Edge 최신 버전)를 지원함
- 블록 타입은 시각적으로 명확히 구별 가능하도록 5~7가지 색상/모양을 사용함
- 초기 버전은 무제한 이동 모드로 구현하며, 이동 횟수/시간 제한은 향후 확장 기능으로 고려
- 사운드/음악은 초기 버전에서 제외하고, 시각적 피드백에만 집중함
- 게임 데이터는 사용자의 로컬 브라우저에만 저장되며, 서버 동기화는 불필요함
- 멀티플레이어 기능은 초기 버전에서 제외함
